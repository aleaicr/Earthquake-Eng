
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Tarea_2_sismica_v2</title><meta name="generator" content="MATLAB 9.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-04-25"><meta name="DC.source" content="Tarea_2_sismica_v2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Inicializar</a></li><li><a href="#2">P1</a></li><li><a href="#3">P1.1</a></li><li><a href="#4">P1.2</a></li><li><a href="#5">P1.3</a></li><li><a href="#6">P2</a></li><li><a href="#7">P3</a></li><li><a href="#8">P3.a</a></li><li><a href="#9">P3.b</a></li><li><a href="#10">P3.c</a></li><li><a href="#11">P3.d</a></li><li><a href="#12">P3.e</a></li></ul></div><h2 id="1">Inicializar</h2><pre class="codeinput">clear <span class="string">variables</span>
close <span class="string">all</span>
clc
</pre><h2 id="2">P1</h2><h2 id="3">P1.1</h2><p>Graficar PGA promedio esperado para un terremoto tipo interplaca vs la distancia r, con las condiciones H = 37 km; r = 10:1:500; Mw = [7.0;8.0;8.8] Comparar resultados</p><pre class="codeinput">C1_rock = 0.00;
C2_rock = 0.00;
C3_rock = -2.552;
C4_rock = 1.45; <span class="comment">% * Standard deviation for magnitud greater than 8 is equal to the value for magnitud equal to 8</span>
C5_rock = -0.1; <span class="comment">% *</span>

<span class="comment">% Para suelo (soil)</span>
C1_soil = 0.00;
C2_soil = 0.00;
C3_soil = -2.329;
C4_soil = 1.45;
C5_soil = -0.1;

Zt_var = 0;
H_var = 37;
Mw_vector = [7.0; 8.0; 8.8];
r = (10:1:500).';

<span class="keyword">for</span> Mw = 1:3
    Mw_var = Mw_vector(Mw,1);
    <span class="keyword">for</span> r_var = 1:length(r)
        puntos_rock(r_var,Mw) = exp(0.2418 + 1.414*Mw_var + C1_rock + C2_rock*(10-Mw_var)^3 + C3_rock*log(r(r_var,1) + 1.7818*exp(0.544*Mw_var)) + 0.00607*H_var + 0.3846*Zt_var);
        puntos_soil(r_var,Mw) = exp(-0.6687 + 1.438*Mw_var + C1_soil + C2_soil*(10-Mw_var)^3 + C3_soil*log(r(r_var,1) + 1.097*exp(0.617*Mw_var)) + 0.00648*H_var + 0.3643*Zt_var);
    <span class="keyword">end</span>
    fprintf(<span class="string">'Mw %f Roca \n'</span>,Mw_var)

    figure
    loglog(r,puntos_rock(:,Mw))
    xlabel(<span class="string">'r [km]'</span>)
    ylabel(<span class="string">'PGA roca[unidad]'</span>)
    title(<span class="string">'PGA para roca, sismo magnitud'</span>, Mw_var)

    fprintf(<span class="string">'Mw %f Suelo \n'</span>,Mw_var)
    figure
    loglog(r,puntos_soil(:,Mw))
    xlabel(<span class="string">'r [km]'</span>)
    ylabel(<span class="string">'PGA suelo[unidad]'</span>)
    title(<span class="string">'PGA para suelo, sismo magnitud'</span>, Mw_var)
<span class="keyword">end</span>
</pre><pre class="codeoutput">Mw 7.000000 Roca 
Mw 7.000000 Suelo 
Mw 8.000000 Roca 
Mw 8.000000 Suelo 
Mw 8.800000 Roca 
Mw 8.800000 Suelo 
</pre><img vspace="5" hspace="5" src="Tarea_2_sismica_v2_01.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_02.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_03.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_04.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_05.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_06.png" alt=""> <h2 id="4">P1.2</h2><p>Para un periodo de <img src="Tarea_2_sismica_v2_eq14957162917779111852.png" alt="$T_n = 2.0 [sec]$"> y un amortiguamiento de <img src="Tarea_2_sismica_v2_eq00193514905240367153.png" alt="$\xi = 0.05$"></p><pre class="codeinput"><span class="comment">% Para roca</span>
C1_rock = -3.328;
C2_rock = -0.0080;
C3_rock = -2.1070;
C4_rock = 1.55;
C5_rock = -0.1;

<span class="comment">% Para suelo</span>
C1_soil = -6.433;
C2_soil = -0.0164;
C3_soil = -1.290;
C4_soil = 1.55;
C5_soil = -0.1;

<span class="keyword">for</span> Mw = 1:3
    Mw_var = Mw_vector(Mw,1);
    <span class="keyword">for</span> r_var = 1:length(r)
        puntos_rock(r_var,Mw) = exp(0.2418 + 1.414*Mw_var + C1_rock + C2_rock*(10-Mw_var)^3 + C3_rock*log(r(r_var,1) + 1.7818*exp(0.544*Mw_var)) + 0.00607*H_var + 0.3846*Zt_var);
        puntos_soil(r_var,Mw) = exp(-0.6687 + 1.438*Mw_var + C1_soil + C2_soil*(10-Mw_var)^3 + C3_soil*log(r(r_var,1) + 1.097*exp(0.617*Mw_var)) + 0.00648*H_var + 0.3643*Zt_var);
    <span class="keyword">end</span>
    fprintf(<span class="string">'Mw %f Roca \n'</span>,Mw_var)

    figure
    loglog(r,puntos_rock(:,Mw))
    xlabel(<span class="string">'r [km]'</span>)
    ylabel(<span class="string">'PGA roca[unidad]'</span>)
    title(<span class="string">'PGA para roca, sismo magnitud'</span>, Mw_var)

    fprintf(<span class="string">'Mw %f Suelo \n'</span>,Mw_var)
    figure
    loglog(r,puntos_soil(:,Mw))
    xlabel(<span class="string">'r [km]'</span>)
    ylabel(<span class="string">'PGA suelo[unidad]'</span>)
    title(<span class="string">'PGA para suelo, sismo magnitud'</span>, Mw_var)
<span class="keyword">end</span>
</pre><pre class="codeoutput">Mw 7.000000 Roca 
Mw 7.000000 Suelo 
Mw 8.000000 Roca 
Mw 8.000000 Suelo 
Mw 8.800000 Roca 
Mw 8.800000 Suelo 
</pre><img vspace="5" hspace="5" src="Tarea_2_sismica_v2_07.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_08.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_09.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_10.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_11.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_12.png" alt=""> <h2 id="5">P1.3</h2><p>No s&eacute; hacerla xd</p><h2 id="6">P2</h2><p>Est&aacute; en Excel completa</p><h2 id="7">P3</h2><h2 id="8">P3.a</h2><p>Definir fRM(r)</p><pre class="codeinput">r_min = 7.2; <span class="comment">% km</span>
L1 = 34.4; <span class="comment">% km</span>
L2 = 62.3; <span class="comment">% km</span>
L = 96.7; <span class="comment">% km</span>

<span class="comment">% Definr fRM(r)</span>
<span class="comment">% La vamos a definir en funci&oacute;n de 'l' para que quede con los subcasos</span>
syms <span class="string">r</span> <span class="string">l</span>
<span class="comment">% fRM(r,l) = piecewise( ...</span>
<span class="comment">%     and(l&lt;L1,L1&lt;L2),piecewise(r == r_min,l/(L-l),and(r&lt;r1,r&gt;r_min),2*(L1-l)/(L-l),and(r&lt;r2,r&gt;r1),(L-2*L1)/(L-l)), ...</span>
<span class="comment">%     and(L1&lt;l,l&lt;L2),piecewise(r==r_min,L1/(L-l),and(r2&gt;r,r&gt;r_min),(L2-l)/(L-l)), ...</span>
<span class="comment">%     and(l&gt;L2,L2&gt;L1),1);</span>

<span class="comment">% % l&lt;L1,L1&lt;L2</span>
<span class="comment">% r11 = (r_min^2+(L1-l)^2)^0.5;</span>
<span class="comment">% r12 = (r_min^2+(L2-l)^2)^0.5;</span>
<span class="comment">% fRM1 = piecewise(r == r_min,l/(L-l),and(r&lt;=r11,r&gt;r_min),r/((L-l)*sqrt(r^2-r_min^2)),and(r&lt;=r12,r&gt;r11),r/((L-l)*sqrt(r^2-r_min^2)));</span>
<span class="comment">% % L1&lt;l&lt;L2</span>
<span class="comment">% r22 = (r_min^2+(L2-l)^2)^0.5;</span>
<span class="comment">% fRM2= piecewise(r==r_min,L1/(L-l),and(r22&gt;=r,r&gt;=r_min),r/((L-l)*sqrt(r^2-r_min^2)));</span>
<span class="comment">% % L1&lt;L2&lt;l</span>
<span class="comment">% fRM3 = piecewise(r==r_min,1,~(r==r_min),0);</span>
</pre><h2 id="9">P3.b</h2><p>En Excel</p><pre class="codeinput">Mmax = 7.38;                                    <span class="comment">% Magnitud de momento m&aacute;xima (con L = 96.7) que la falla es capaz de producir</span>
</pre><h2 id="10">P3.c</h2><p>En Excel</p><pre class="codeinput">l_vals = [43.72; 12.43; 6.62; 1.882]; <span class="comment">%km</span>
<span class="comment">% magn = [0.95*Mmax; 0.85*Mmax; 0.8*Mmax;0.7*Mmax];</span>
</pre><h2 id="11">P3.d</h2><pre class="codeinput"><span class="keyword">for</span> i = 1:length(l_vals)
    l = l_vals(i,1);
    l_val = l;
    <span class="keyword">if</span> and(l_val&lt;=L1,l_val&lt;=L2)
        r1(i,1) = (r_min^2+(L1-l)^2)^0.5;
        r11 = r1(i,1);
        r2(i,1) = (r_min^2+(L2-l)^2)^0.5;
        r12 = r2(i,1);
        fRr(i,1) = piecewise(r == r_min,l/(L-l),and(r&lt;=r11,r&gt;r_min),r/((L-l)*sqrt(r^2-r_min^2)),and(r&lt;=r12,r&gt;r11),r/((L-l)*sqrt(r^2-r_min^2)));
    <span class="keyword">elseif</span> and(l_val&gt;L1, l_val&lt;L2)
        r2(i,1) = (r_min^2+(L2-l)^2)^0.5;
        r22 = r2(i,1);
        fRr(i,1)= piecewise(r==r_min,L1/(L-l),and(r22&gt;=r,r&gt;=r_min),r/((L-l)*sqrt(r^2-r_min^2)));
    <span class="keyword">elseif</span> l_val&gt;=L2
        fRr(i,1) = piecewise(r==r_min,1,~(r==r_min),0);                                        <span class="comment">% Coordenada 1 es fR(r), no tiene ni r1 ni r2</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

clear <span class="string">l_val</span> <span class="string">r11</span> <span class="string">r12</span> <span class="string">r22</span>
close <span class="string">all</span>

figure
hold <span class="string">on</span>
grid <span class="string">on</span>
<span class="keyword">for</span> i = 1:length(l_vals)
    fplot(fRr(i,1),[r_min r2(i,1)])
<span class="keyword">end</span>
xlabel(<span class="string">'r [km]'</span>)
ylabel(<span class="string">'f_{R}(r)'</span>)
title(<span class="string">'Funciones de densidad de probabilidad para las cuatro longitudes de ruptura'</span>)
legend(<span class="string">'l = 43.72km; Magn = 7.01'</span>,<span class="string">'l = 12.42km; Magn = 6.27'</span>,<span class="string">'l = 6.62km; Magn = 5.90'</span>,<span class="string">'l = 1.88km; Magn = 5.16'</span>)
</pre><img vspace="5" hspace="5" src="Tarea_2_sismica_v2_13.png" alt=""> <h2 id="12">P3.e</h2><pre class="codeinput"><span class="comment">% Para el caso de ruptura asociado a 0.7Mmax  =&gt; l = 1.882km</span>
<span class="comment">% Aproximar fR(r) num&eacute;ricamente utilizando histogramas</span>

<span class="comment">% 1. Dividir la falla en segmentos de longitud dx</span>
Dx = [0.1; 1; 2]; <span class="comment">%km</span>
<span class="comment">% Para cada divisi&oacute;n, calcular la distancia ri asociada</span>
pos_x = zeros(L/min(Dx),L/min(Dx));
x_0 = 0;
<span class="keyword">for</span> i = 1:length(Dx)
    <span class="keyword">for</span> j = 1:L/Dx(i,1)
        pos_x(j,i) = x_0 + Dx(i,1)*j;
    <span class="keyword">end</span><span class="comment">% Columna 1 contiene posici&oacute;n x cada 0.1, columna 2 cada 1km, columna 3 cada 2km</span>
<span class="keyword">end</span>
<span class="comment">% Determinamos ri para cada segmento</span>
<span class="keyword">for</span> i = 1:length(Dx)
    <span class="keyword">for</span> j = 1:length(pos_x(:,i))
        <span class="keyword">if</span> pos_x(j,i) &lt; L1
            ri(j,i) = sqrt((L1 - pos_x(j,i))^2 + r_min^2);
        <span class="keyword">end</span>
        <span class="keyword">if</span> pos_x(j,i) &gt; L1
            ri(j,i) = sqrt((pos_x(j,i) - L1)^2 + r_min^2);
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">% Determinamos cantidad de veces que se repite un ri dentro del rango R</span>

DR = [1;2.5;5]; <span class="comment">% km</span>
r2max = (r_min^2 + L2^2)^0.5;
R_0 = r_min;
<span class="keyword">for</span> i = 1:length(DR)
    <span class="keyword">for</span> j = 1:r2max/DR(i,1)
        R_range(j,i) = R_0 + DR(i,1)*(j-1);                             <span class="comment">%Creo un rango de R+DR.... R+DR...</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
disp(<span class="string">'Se muestra R_range'</span>)
disp(R_range)

R_frec = zeros(length(R_range),length(Dx));                             <span class="comment">% Inicializo matriz de zeros(Rango_R1,Rango_R2,Rango_R3), pero nos quedamos con el mayor</span>

<span class="keyword">for</span> i = 1:length(Dx)                                                    <span class="comment">% Para cada Dx, justo calza tambi&eacute;n con para cada DR</span>
    <span class="keyword">for</span> k = 1:length(R_range(:,i))-1                                      <span class="comment">% Para cada Rango_R, no pasa nada si partimos de</span>
        <span class="keyword">for</span> j = 1:length(ri(:,i))                                       <span class="comment">% Para cada largo del Dx asociaso</span>
            <span class="keyword">if</span> and(ri(j,i) &gt; R_range(k,i) , ri(j,i) &lt; R_range(k+1,i))   <span class="comment">% Si ri est&aacute; dentro del rango</span>
                p = R_frec(k,i);
                R_frec(k,i) = p + 1;                                    <span class="comment">% Si est&aacute; dentro del rango, sumamos uno, si no entonces no pasa nada</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">% Normalizando</span>

<span class="keyword">for</span> i = 1:length(DR)
    total = sum(R_frec(:,i));
    R_frec_normalizado(:,i) = R_frec(:,i)/total;
<span class="keyword">end</span>


disp(<span class="string">'Se muestra R_frec'</span>)
disp(R_frec)
disp(<span class="string">'Se muestra R_frec'</span>)
disp(R_frec_normalizado)

<span class="comment">% Graficamos</span>
<span class="keyword">for</span> i = 1:length(DR)
    figure
    hold <span class="string">on</span>
    grid <span class="string">on</span>
    histogram(R_frec_normalizado(:,i).')
    xlabel(<span class="string">'r [km]'</span>)
    ylabel(<span class="string">'f_{R}(r)'</span>)
    title(<span class="string">'Funciones de densidad de probabilidad para las cuatro longitudes de ruptura'</span>)
    legend(<span class="string">'l = 43.72km; Magn = 7.01'</span>,<span class="string">'l = 12.42km; Magn = 6.27'</span>,<span class="string">'l = 6.62km; Magn = 5.90'</span>,<span class="string">'l = 1.88km; Magn = 5.16'</span>)
    hold <span class="string">off</span>
<span class="keyword">end</span>

<span class="comment">% table(R_range,R_frec)</span>
</pre><pre class="codeoutput">Se muestra R_range
    7.2000    7.2000    7.2000
    8.2000    9.7000   12.2000
    9.2000   12.2000   17.2000
   10.2000   14.7000   22.2000
   11.2000   17.2000   27.2000
   12.2000   19.7000   32.2000
   13.2000   22.2000   37.2000
   14.2000   24.7000   42.2000
   15.2000   27.2000   47.2000
   16.2000   29.7000   52.2000
   17.2000   32.2000   57.2000
   18.2000   34.7000   62.2000
   19.2000   37.2000         0
   20.2000   39.7000         0
   21.2000   42.2000         0
   22.2000   44.7000         0
   23.2000   47.2000         0
   24.2000   49.7000         0
   25.2000   52.2000         0
   26.2000   54.7000         0
   27.2000   57.2000         0
   28.2000   59.7000         0
   29.2000   62.2000         0
   30.2000   64.7000         0
   31.2000   67.2000         0
   32.2000         0         0
   33.2000         0         0
   34.2000         0         0
   35.2000         0         0
   36.2000         0         0
   37.2000         0         0
   38.2000         0         0
   39.2000         0         0
   40.2000         0         0
   41.2000         0         0
   42.2000         0         0
   43.2000         0         0
   44.2000         0         0
   45.2000         0         0
   46.2000         0         0
   47.2000         0         0
   48.2000         0         0
   49.2000         0         0
   50.2000         0         0
   51.2000         0         0
   52.2000         0         0
   53.2000         0         0
   54.2000         0         0
   55.2000         0         0
   56.2000         0         0
   57.2000         0         0
   58.2000         0         0
   59.2000         0         0
   60.2000         0         0
   61.2000         0         0
   62.2000         0         0
   63.2000         0         0
   64.2000         0         0
   65.2000         0         0
   66.2000         0         0
   67.2000         0         0
   68.2000         0         0

Se muestra R_frec
    78    13    10
    36     7     6
    30     6     5
    26     6     5
    26     4     5
    24     6   923
    24     6     2
    22     4     3
    24     6     3
    22     4     2
    22     6     3
    20   873     0
    22     3     0
    22     2     0
    20     3     0
    21     3     0
    22     2     0
    20     3     0
    20     2     0
    22     3     0
    20     2     0
    20     3     0
    22     0     0
    20     0     0
    20     0     0
    22     0     0
    20     0     0
    19     0     0
    10     0     0
    10     0     0
    11     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    11     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    11     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
    10     0     0
     6     0     0
     0     0     0
     0     0     0
     0     0     0
     0     0     0
     0     0     0
     0     0     0

Se muestra R_frec
    0.0808    0.0134    0.0103
    0.0373    0.0072    0.0062
    0.0311    0.0062    0.0052
    0.0269    0.0062    0.0052
    0.0269    0.0041    0.0052
    0.0249    0.0062    0.9545
    0.0249    0.0062    0.0021
    0.0228    0.0041    0.0031
    0.0249    0.0062    0.0031
    0.0228    0.0041    0.0021
    0.0228    0.0062    0.0031
    0.0207    0.9028         0
    0.0228    0.0031         0
    0.0228    0.0021         0
    0.0207    0.0031         0
    0.0218    0.0031         0
    0.0228    0.0021         0
    0.0207    0.0031         0
    0.0207    0.0021         0
    0.0228    0.0031         0
    0.0207    0.0021         0
    0.0207    0.0031         0
    0.0228         0         0
    0.0207         0         0
    0.0207         0         0
    0.0228         0         0
    0.0207         0         0
    0.0197         0         0
    0.0104         0         0
    0.0104         0         0
    0.0114         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0114         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0114         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0104         0         0
    0.0062         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0
         0         0         0

Warning: Ignoring extra legend entries. 
Warning: Ignoring extra legend entries. 
Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="Tarea_2_sismica_v2_14.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_15.png" alt=""> <img vspace="5" hspace="5" src="Tarea_2_sismica_v2_16.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Inicializar
clear variables
close all
clc
%% P1
%% P1.1
% Graficar PGA promedio esperado para un terremoto tipo interplaca vs la
% distancia r, con las condiciones
% H = 37 km; r = 10:1:500; Mw = [7.0;8.0;8.8]
% Comparar resultados
C1_rock = 0.00;
C2_rock = 0.00;
C3_rock = -2.552;
C4_rock = 1.45; % * Standard deviation for magnitud greater than 8 is equal to the value for magnitud equal to 8
C5_rock = -0.1; % *

% Para suelo (soil)
C1_soil = 0.00;
C2_soil = 0.00;
C3_soil = -2.329;
C4_soil = 1.45;
C5_soil = -0.1;

Zt_var = 0;
H_var = 37;
Mw_vector = [7.0; 8.0; 8.8];
r = (10:1:500).';

for Mw = 1:3
    Mw_var = Mw_vector(Mw,1);
    for r_var = 1:length(r)
        puntos_rock(r_var,Mw) = exp(0.2418 + 1.414*Mw_var + C1_rock + C2_rock*(10-Mw_var)^3 + C3_rock*log(r(r_var,1) + 1.7818*exp(0.544*Mw_var)) + 0.00607*H_var + 0.3846*Zt_var);
        puntos_soil(r_var,Mw) = exp(-0.6687 + 1.438*Mw_var + C1_soil + C2_soil*(10-Mw_var)^3 + C3_soil*log(r(r_var,1) + 1.097*exp(0.617*Mw_var)) + 0.00648*H_var + 0.3643*Zt_var);
    end
    fprintf('Mw %f Roca \n',Mw_var)

    figure
    loglog(r,puntos_rock(:,Mw))
    xlabel('r [km]')
    ylabel('PGA roca[unidad]')
    title('PGA para roca, sismo magnitud', Mw_var)

    fprintf('Mw %f Suelo \n',Mw_var)
    figure
    loglog(r,puntos_soil(:,Mw))
    xlabel('r [km]')
    ylabel('PGA suelo[unidad]')
    title('PGA para suelo, sismo magnitud', Mw_var)
end


%% P1.2
% Para un periodo de $T_n = 2.0 [sec]$ y un amortiguamiento de $\xi = 0.05$

% Para roca
C1_rock = -3.328;
C2_rock = -0.0080;
C3_rock = -2.1070;
C4_rock = 1.55;
C5_rock = -0.1;

% Para suelo
C1_soil = -6.433;
C2_soil = -0.0164;
C3_soil = -1.290;
C4_soil = 1.55;
C5_soil = -0.1;

for Mw = 1:3
    Mw_var = Mw_vector(Mw,1);
    for r_var = 1:length(r)
        puntos_rock(r_var,Mw) = exp(0.2418 + 1.414*Mw_var + C1_rock + C2_rock*(10-Mw_var)^3 + C3_rock*log(r(r_var,1) + 1.7818*exp(0.544*Mw_var)) + 0.00607*H_var + 0.3846*Zt_var);
        puntos_soil(r_var,Mw) = exp(-0.6687 + 1.438*Mw_var + C1_soil + C2_soil*(10-Mw_var)^3 + C3_soil*log(r(r_var,1) + 1.097*exp(0.617*Mw_var)) + 0.00648*H_var + 0.3643*Zt_var);
    end
    fprintf('Mw %f Roca \n',Mw_var)

    figure
    loglog(r,puntos_rock(:,Mw))
    xlabel('r [km]')
    ylabel('PGA roca[unidad]')
    title('PGA para roca, sismo magnitud', Mw_var)

    fprintf('Mw %f Suelo \n',Mw_var)
    figure
    loglog(r,puntos_soil(:,Mw))
    xlabel('r [km]')
    ylabel('PGA suelo[unidad]')
    title('PGA para suelo, sismo magnitud', Mw_var)
end

%% P1.3
% No sé hacerla xd


%% P2
% Está en Excel completa


%% P3
%% P3.a
% Definir fRM(r)
r_min = 7.2; % km
L1 = 34.4; % km
L2 = 62.3; % km
L = 96.7; % km

% Definr fRM(r)
% La vamos a definir en función de 'l' para que quede con los subcasos
syms r l
% fRM(r,l) = piecewise( ...
%     and(l<L1,L1<L2),piecewise(r == r_min,l/(L-l),and(r<r1,r>r_min),2*(L1-l)/(L-l),and(r<r2,r>r1),(L-2*L1)/(L-l)), ...
%     and(L1<l,l<L2),piecewise(r==r_min,L1/(L-l),and(r2>r,r>r_min),(L2-l)/(L-l)), ...
%     and(l>L2,L2>L1),1);

% % l<L1,L1<L2
% r11 = (r_min^2+(L1-l)^2)^0.5;
% r12 = (r_min^2+(L2-l)^2)^0.5;
% fRM1 = piecewise(r == r_min,l/(L-l),and(r<=r11,r>r_min),r/((L-l)*sqrt(r^2-r_min^2)),and(r<=r12,r>r11),r/((L-l)*sqrt(r^2-r_min^2)));
% % L1<l<L2
% r22 = (r_min^2+(L2-l)^2)^0.5;
% fRM2= piecewise(r==r_min,L1/(L-l),and(r22>=r,r>=r_min),r/((L-l)*sqrt(r^2-r_min^2)));
% % L1<L2<l
% fRM3 = piecewise(r==r_min,1,~(r==r_min),0);

%% P3.b
% En Excel
Mmax = 7.38;                                    % Magnitud de momento máxima (con L = 96.7) que la falla es capaz de producir

%% P3.c
% En Excel
l_vals = [43.72; 12.43; 6.62; 1.882]; %km
% magn = [0.95*Mmax; 0.85*Mmax; 0.8*Mmax;0.7*Mmax];

%% P3.d

for i = 1:length(l_vals)
    l = l_vals(i,1);
    l_val = l;
    if and(l_val<=L1,l_val<=L2)
        r1(i,1) = (r_min^2+(L1-l)^2)^0.5;
        r11 = r1(i,1);
        r2(i,1) = (r_min^2+(L2-l)^2)^0.5;
        r12 = r2(i,1);
        fRr(i,1) = piecewise(r == r_min,l/(L-l),and(r<=r11,r>r_min),r/((L-l)*sqrt(r^2-r_min^2)),and(r<=r12,r>r11),r/((L-l)*sqrt(r^2-r_min^2)));
    elseif and(l_val>L1, l_val<L2)
        r2(i,1) = (r_min^2+(L2-l)^2)^0.5;
        r22 = r2(i,1);
        fRr(i,1)= piecewise(r==r_min,L1/(L-l),and(r22>=r,r>=r_min),r/((L-l)*sqrt(r^2-r_min^2))); 
    elseif l_val>=L2
        fRr(i,1) = piecewise(r==r_min,1,~(r==r_min),0);                                        % Coordenada 1 es fR(r), no tiene ni r1 ni r2
    end
end

clear l_val r11 r12 r22
close all

figure
hold on
grid on
for i = 1:length(l_vals)
    fplot(fRr(i,1),[r_min r2(i,1)])
end
xlabel('r [km]')
ylabel('f_{R}(r)')
title('Funciones de densidad de probabilidad para las cuatro longitudes de ruptura')
legend('l = 43.72km; Magn = 7.01','l = 12.42km; Magn = 6.27','l = 6.62km; Magn = 5.90','l = 1.88km; Magn = 5.16')

%% P3.e

% Para el caso de ruptura asociado a 0.7Mmax  => l = 1.882km
% Aproximar fR(r) numéricamente utilizando histogramas

% 1. Dividir la falla en segmentos de longitud dx
Dx = [0.1; 1; 2]; %km
% Para cada división, calcular la distancia ri asociada
pos_x = zeros(L/min(Dx),L/min(Dx));
x_0 = 0;
for i = 1:length(Dx)
    for j = 1:L/Dx(i,1)
        pos_x(j,i) = x_0 + Dx(i,1)*j;
    end% Columna 1 contiene posición x cada 0.1, columna 2 cada 1km, columna 3 cada 2km
end
% Determinamos ri para cada segmento
for i = 1:length(Dx)
    for j = 1:length(pos_x(:,i))
        if pos_x(j,i) < L1
            ri(j,i) = sqrt((L1 - pos_x(j,i))^2 + r_min^2);
        end
        if pos_x(j,i) > L1
            ri(j,i) = sqrt((pos_x(j,i) - L1)^2 + r_min^2);
        end
    end
end

% Determinamos cantidad de veces que se repite un ri dentro del rango R

DR = [1;2.5;5]; % km
r2max = (r_min^2 + L2^2)^0.5;
R_0 = r_min;
for i = 1:length(DR)
    for j = 1:r2max/DR(i,1)
        R_range(j,i) = R_0 + DR(i,1)*(j-1);                             %Creo un rango de R+DR.... R+DR...    
    end
end
disp('Se muestra R_range')
disp(R_range)

R_frec = zeros(length(R_range),length(Dx));                             % Inicializo matriz de zeros(Rango_R1,Rango_R2,Rango_R3), pero nos quedamos con el mayor

for i = 1:length(Dx)                                                    % Para cada Dx, justo calza también con para cada DR
    for k = 1:length(R_range(:,i))-1                                      % Para cada Rango_R, no pasa nada si partimos de 
        for j = 1:length(ri(:,i))                                       % Para cada largo del Dx asociaso
            if and(ri(j,i) > R_range(k,i) , ri(j,i) < R_range(k+1,i))   % Si ri está dentro del rango 
                p = R_frec(k,i);
                R_frec(k,i) = p + 1;                                    % Si está dentro del rango, sumamos uno, si no entonces no pasa nada
            end
        end
    end
end

% Normalizando

for i = 1:length(DR)
    total = sum(R_frec(:,i));
    R_frec_normalizado(:,i) = R_frec(:,i)/total;
end


disp('Se muestra R_frec')
disp(R_frec)
disp('Se muestra R_frec')
disp(R_frec_normalizado)

% Graficamos
for i = 1:length(DR)
    figure
    hold on
    grid on
    histogram(R_frec_normalizado(:,i).')
    xlabel('r [km]')
    ylabel('f_{R}(r)')
    title('Funciones de densidad de probabilidad para las cuatro longitudes de ruptura')
    legend('l = 43.72km; Magn = 7.01','l = 12.42km; Magn = 6.27','l = 6.62km; Magn = 5.90','l = 1.88km; Magn = 5.16')
    hold off
end

% table(R_range,R_frec)

##### SOURCE END #####
--></body></html>